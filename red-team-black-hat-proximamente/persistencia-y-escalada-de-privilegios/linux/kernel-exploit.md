# Kernel Exploit

Las vulnerabilidades del kernel pueden dejar el sistema en un estado inestable, por lo que solo debes ejecutarlas como último recurso.

Ejecuta la herramienta Linux Exploit Suggester 2 para identificar posibles exploits del kernel en el sistema actual:

[linux-exploit-suggester | Kali Linux Tools](https://www.kali.org/tools/linux-exploit-suggester/)

```bash
linux-exploit-suggester-2.pl
```

Por ejemplo en [TryHackMe | Linux PrivEsc](https://tryhackme.com/r/room/linuxprivesc) debería aparecer listado el exploit del kernel de Linux "Dirty COW".&#x20;

Este reemplaza el archivo SUID /usr/bin/passwd por uno que genera una shell (se hace una copia de seguridad de /usr/bin/passwd en /tmp/bak).

Compila el código y ejecútalo:

```bash
gcc -pthread /home/user/tools/kernel-exploits/dirtycow/c0w.c -o c0w ./c0w
```

Una vez que se complete el exploit, ejecuta /usr/bin/passwd para obtener una shell de root:

```bash
/usr/bin/passwd
```

Antes de salir del root deberas restaurar el archivo original /usr/bin/passwd y salir de la shell de root.

```bash
mv /tmp/bak /usr/bin/passwd
exit
```

#### Lista

[Linux Kernel < 2.6.37-rc2 ACPI custom\_method Privilege Escalation](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C0\_\_TO\_\_\_2%2C6%2C36.c)\
[Linux Kernel - 5.8 < 5.16.11 - Local Privilege Escalation (DirtyPipe)](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_\_5%2C8%2C0\_\_TO\_\_5%2C16%2C11.c)\
[Linux Kernel - 2.4.20 To 2.4.27 mremap missing do\_munmap return check kernel exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C4%2C20\_\_TO\_\_2%2C4%2C27.c)\
[Linux Kernel - 2.4.29 uselib VMA insert race vulnerability](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C4%2C29.c)\
[Linux Kernel < 2.6.36-rc6 pktcdvd Kernel Memory Disclosure](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C0\_\_TO\_\_\_2%2C6%2C36.c)\
[Linux Kernel < 2.6.36.2 Econet Privilege Escalation Exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_\_2%2C6%2C0\_\_TO\_\_2%2C6%2C36.c)\
[Linux Kernel < 2.6.11 Local integer overflow Exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C5\_\_TO\_\_2%2C6%2C11.c)\
[Linux Kernel - 2.6.0-2.6.16 Local Race](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C8\_\_TO\_\_2%2C6%2C16.c)\
[Linux kernel < 2.6.22 open/ftruncate local exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C11\_\_TO\_\_2%2C6%2C22.c)\
[Linux Kernel < 2.6.36-rc1 CAN BCM Privilege Escalation Exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C18\_\_TO\_\_2%2C6%2C36.c)\
[Linux Kernel - 2.6.28 To 3.7.6 \_X86\_MSR Exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C18\_\_TO\_\_3%2C7%2C6.c)\
[Linux kernel <2.6.29 exit\_notify() local root exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C25\_\_TO\_\_2%2C6%2C29.sh)\
[Linux Kernel- 2.6.34 To 2.6.36 CAP\_SYS\_ADMIN to root exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_2%2C6%2C34\_\_TO\_\_2%2C6%2C36.c)\
[Linux Kernel - 3.0 To 3.8.9 perf\_swevent\_init Local root exploit](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_3%2C0%2C0\_\_TO\_\_3%2C8%2C9.c)\
[Linux Kernel - 3.4.0 To 3.13.1 CVE-2014-0038](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_3%2C4%2C0\_\_TO\_\_3%2C13%2C1.c)\
[Linux Kernel- 3.8.0 To 3.13.1 CVE-2016-072 PP\_KEY](https://github.com/sujayadkesar/Linux-Privilege-Escalation/blob/main/Kernel\_EXPLOITS/kernel\_3%2C8%2C0\_\_TO\_\_3%2C13%2C1.c)
