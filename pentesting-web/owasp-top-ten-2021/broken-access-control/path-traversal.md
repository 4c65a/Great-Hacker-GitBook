---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Path Traversal

Una vulnerabilidad path traversal puede permitir a los atacantes acceder a archivos y directorios almacenados fuera de la carpeta raíz web.

Es posible explotar las vulnerabilidades de cruce de rutas manipulando variables que hacen referencia a archivos con la secuencia punto-punto-barra ( **../** ) y sus variaciones o utilizando rutas absolutas de archivos para acceder a archivos en el sistema vulnerable. Un atacante puede obtener información crítica y confidencial al explotar las vulnerabilidades de cruce de directorios.

La muestra la siguiente URL en uso:

```
http://192.168.78.8:66/vulnerabilities/fi/?page=../../../../../etc/passwd
```

La aplicación vulnerable muestra el contenido del archivo **/etc/passwd** al atacante.

Es posible utilizar la codificación de URL, como se demuestra en el siguiente ejemplo, para explotar las vulnerabilidades de recorrido del directorio (ruta):

```
  %2e%2e%2f is the same as ../
  %2e%2e/ is the same as ../
  ..%2f is the same as ../
  %2e%2e%5c is the same as ..\
```

Un atacante también puede utilizar otras combinaciones de codificación, por ejemplo, estructuras de ruta específicas del sistema operativo como **/** en sistemas Linux o macOS y **\\** en Windows.

El producto utiliza entradas externas para construir un nombre de ruta que debería estar dentro de un directorio restringido, pero no neutraliza adecuadamente '.../...//' (barra diagonal doble de triple punto) que pueden resolverse en una ubicación que está fuera de ese directorio.![+](https://cwe.mitre.org/images/head\_more.gif) Descripción ampliada

Esto permite a los atacantes atravesar el sistema de archivos para acceder a archivos o directorios que están fuera del directorio restringido.

El '.../...//' La manipulación es útil para eludir algunos esquemas de protección de recorrido de ruta. Si "../" se filtra de forma secuencial, como lo hacen algunos motores de expresiones regulares, luego ".../...//" puede colapsar en el directorio "../" valor no seguro ([CWE-182](https://cwe.mitre.org/data/definitions/182.html)). Eliminando el primer "../" produce "....//"; la segunda eliminación produce "../". Dependiendo del algoritmo, el producto podría ser susceptible a [CWE-34](https://cwe.mitre.org/data/definitions/34.html) pero no a [CWE-35](https://cwe.mitre.org/data/definitions/35.html). , o viceversa.

## Relative Path Traversal

The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as ".." that can resolve to a location that is outside of that directory.![+](https://cwe.mitre.org/images/head\_more.gif) Extended DescriptionThis allows attackers to traverse the file system to access files or directories that are outside of the restricted directory.

<mark style="color:red;">**Recursos**</mark>

{% embed url="https://cwe.mitre.org/data/definitions/22.html" %}

{% embed url="https://cwe.mitre.org/data/definitions/23.html" %}

{% embed url="https://cwe.mitre.org/data/definitions/35.html" %}

{% embed url="https://www.akimbocore.com/article/linux-path-traversal-cheat-sheet/" %}

{% embed url="https://owasp.org/www-community/attacks/Path_Traversal" %}

{% embed url="https://book.hacktricks.xyz/pentesting-web/file-inclusion" %}

{% embed url="https://portswigger.net/web-security/file-path-traversal" %}
