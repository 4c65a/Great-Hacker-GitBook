---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Path Traversal

Una vulnerabilidad path traversal puede permitir a los atacantes acceder a archivos y directorios almacenados fuera de la carpeta raíz web.

Es posible explotar las vulnerabilidades de cruce de rutas manipulando variables que hacen referencia a archivos con la secuencia punto-punto-barra ( **../** ) y sus variaciones o utilizando rutas absolutas de archivos para acceder a archivos en el sistema vulnerable. Un atacante puede obtener información crítica y confidencial al explotar las vulnerabilidades de cruce de directorios.

La muestra la siguiente URL en uso:

```
http://192.168.78.8:66/vulnerabilities/fi/?page=../../../../../etc/passwd
```

La aplicación vulnerable muestra el contenido del archivo **/etc/passwd** al atacante.

Es posible utilizar la codificación de URL, como se demuestra en el siguiente ejemplo, para explotar las vulnerabilidades de recorrido del directorio (ruta):

```
  %2e%2e%2f is the same as ../
  %2e%2e/ is the same as ../
  ..%2f is the same as ../
  %2e%2e%5c is the same as ..\
```

Un atacante también puede utilizar otras combinaciones de codificación, por ejemplo, estructuras de ruta específicas del sistema operativo como **/** en sistemas Linux o macOS y **\\** en Windows.

Tambien se pueden realizar otro tipos de pruebas con '.../...//'  un sitio web tal vez no puede neutralizar adecuadamente '.../...//'  que pueden resolverse en una ubicación que está fuera de ese directorio.

Esto permite a los atacantes atravesar el sistema de archivos para acceder a archivos o directorios que están fuera del directorio restringido.

El '.../...//' La manipulación es útil para eludir algunos esquemas de protección de recorrido de ruta. Si "../" se filtra de forma secuencial, como lo hacen algunos motores de expresiones regulares, luego ".../...//" puede colapsar en el directorio "../" valor no seguro . Eliminando el primer "../" produce "....//"; la segunda eliminación produce "../".

## Relative Path Traversal

El producto utiliza entradas externas para construir un nombre de ruta que debería estar dentro de un directorio restringido, pero no neutraliza adecuadamente secuencias como ".." que puede resolverse en una ubicación que está fuera de ese directorio.Esto permite a los atacantes atravesar el sistema de archivos para acceder a archivos o directorios que están fuera del directorio restringido.

Ejemplo 1

Las siguientes URL son vulnerables a este ataque:

(código incorrecto) http://example.com.br/get-files.jsp?file=report.pdf\
http://example.com.br/get-page.php ?home=aaa.html\
http://example.com.br/some-page.asp?page=index.html

Una forma sencilla de ejecutar este ataque es la siguiente:

(código de ataque) http://ejemplo.com.br/get-files?file=../../../../somedir/somefile\
http://ejemplo .com.br/../../../../etc/shadow\
http://example.com.br/get-files?file=../.. /../../etc/contraseña

Ejemplo 2

El siguiente código podría ser para una aplicación de red social en la que la información del perfil de cada usuario se almacena en un archivo separado. Todos los archivos se almacenan en un único directorio.

(código incorrecto)Lenguaje de ejemplo: Perl mi $dataPath = "/users/cwe/profiles";\
mi $nombre de usuario = param("usuario");\
mi $rutaperfil = $rutadatos . "/" . $nombredeusuario;\
\
open(mi $fh, "<", $profilePath) || ExitError("error de lectura de perfil: $profilePath");\
imprimir "\<ul>\n";\
mientras (<$fh>) {imprimir "\<li>$\_\</li>\n";}\
imprimir "\</ul>\n";

Si bien el programador pretende acceder a archivos como "/users/cwe/profiles/alice" o "/users/cwe/profiles/bob", no hay verificación del parámetro de usuario entrante. Un atacante podría proporcionar una cadena como:

(código de ataque) ../../../etc/contraseña

El programa generaría una ruta de perfil como esta:

(resultado) /usuarios/cwe/profiles/../../../etc/contraseña

Cuando se abre el archivo, el sistema operativo resuelve el problema "../" durante la canonicalización de la ruta y realmente accede a este archivo:

(resultado) /etc/contraseña

Como resultado, el atacante podría leer el texto completo del archivo de contraseña.

Observe cómo este código también contiene una fuga de información de mensaje de error ([CWE-209](https://cwe.mitre.org/data/definitions/209.html)) si el parámetro de usuario no genera un archivo que exista. : se proporciona la ruta completa. Debido a la falta de codificación de salida del archivo que se recupera, también puede haber un problema de secuencias de comandos entre sitios ([CWE-79](https://cwe.mitre.org/data/definitions/79.html)) si el perfil contiene cualquier HTML, pero sería necesario examinar otro código.

#### Practicar:

{% embed url="https://portswigger.net/web-security/file-path-traversal" %}

<mark style="color:red;">**Recursos**</mark>

{% embed url="https://cwe.mitre.org/data/definitions/22.html" %}

{% embed url="https://cwe.mitre.org/data/definitions/23.html" %}

{% embed url="https://cwe.mitre.org/data/definitions/35.html" %}

{% embed url="https://www.akimbocore.com/article/linux-path-traversal-cheat-sheet/" %}

{% embed url="https://owasp.org/www-community/attacks/Path_Traversal" %}

{% embed url="https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/Directory%20Traversal/" %}

{% embed url="https://book.hacktricks.xyz/pentesting-web/file-inclusion" %}

{% embed url="https://portswigger.net/web-security/file-path-traversal" %}
