---
description: Control de acceso roto
---

# Broken access control

El control de acceso ,que los usuarios no pueden actuar fuera de sus permisos previstos. Los fallos suelen dar lugar a accesos no autorizados. divulgación de información, modificación o destrucción de todos los datos o realizar una función comercial fuera de los límites del usuario.

### &#x20;Acceso común Las vulnerabilidades de control incluyen:

* Violación del principio de privilegio mínimo o denegación por defecto, donde el acceso sólo debe otorgarse para capacidades particulares, roles o usuarios, pero está disponible para cualquiera.
* Eludir las comprobaciones de control de acceso modificando la URL (parámetro manipulación o navegación forzada), el estado interno de la aplicación o el página HTML o mediante el uso de una herramienta de ataque que modifique las solicitudes de API.
* Permitir ver o editar la cuenta de otra persona, proporcionando su identificador único (referencias directas a objetos inseguros)
* Accediendo a API a la que le faltan controles de acceso para POST, PUT y DELETE.
* Elevación de privilegios. Actuar como usuario sin haber iniciado sesión o actuando como administrador cuando inicia sesión como usuario.
* Manipulación de metadatos, como reproducir o alterar un JSON Token de control de acceso Web Token (JWT), o una cookie o un campo oculto manipulado para elevar privilegios o abusar de la invalidación de JWT.
* La configuración incorrecta de CORS permite el acceso a API desde personas no autorizadas/no confiables orígenes.
* Forzar la navegación a páginas autenticadas como usuario no autenticado o a páginas privilegiadas como usuario estándar.



### Ejemplos de escenarios de ataque <a href="#example-attack-scenarios" id="example-attack-scenarios"></a>

**Escenario #1:** La aplicación utiliza datos no verificados en una llamada SQL que está accediendo a la información de la cuenta:

```
 pstmt.setString(1, request.getParameter("acct"));
 ResultSet results = pstmt.executeQuery( );
```

Un atacante simplemente modifica la "cuenta" del navegador. parámetro a enviar cualquier número de cuenta que quieran. Si no se verifica correctamente, el El atacante puede acceder a la cuenta de cualquier usuario.

```
 https://example.com/app/accountInfo?acct=notmyacct
```

**Escenario n.º 2:** Un atacante simplemente fuerza la navegación a las URL de destino. Administración Se requieren derechos para acceder a la página de administración.

```
 https://example.com/app/getappInfo
 https://example.com/app/admin_getappInfo
```

Si un usuario no autenticado puede acceder a cualquiera de las páginas, se trata de un defecto. si un los no administradores pueden acceder a la página de administración, esto es un defecto.

### Lista de Mapeados CWEs <a href="#list-of-mapped-cwes" id="list-of-mapped-cwes"></a>

[CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')](https://cwe.mitre.org/data/definitions/22.html)

[CWE-23 Relative Path Traversal](https://cwe.mitre.org/data/definitions/23.html)

[CWE-35 Path Traversal: '.../...//'](https://cwe.mitre.org/data/definitions/35.html)

[CWE-59 Improper Link Resolution Before File Access ('Link Following')](https://cwe.mitre.org/data/definitions/59.html)

[CWE-200 Exposure of Sensitive Information to an Unauthorized Actor](https://cwe.mitre.org/data/definitions/200.html)

[CWE-201 Exposure of Sensitive Information Through Sent Data](https://cwe.mitre.org/data/definitions/201.html)

[CWE-219 Storage of File with Sensitive Data Under Web Root](https://cwe.mitre.org/data/definitions/219.html)

[CWE-264 Permissions, Privileges, and Access Controls (should no longer be used)](https://cwe.mitre.org/data/definitions/264.html)

[CWE-275 Permission Issues](https://cwe.mitre.org/data/definitions/275.html)

[CWE-276 Incorrect Default Permissions](https://cwe.mitre.org/data/definitions/276.html)

[CWE-284 Improper Access Control](https://cwe.mitre.org/data/definitions/284.html)

[CWE-285 Improper Authorization](https://cwe.mitre.org/data/definitions/285.html)

[CWE-352 Cross-Site Request Forgery (CSRF)](https://cwe.mitre.org/data/definitions/352.html)

[CWE-359 Exposure of Private Personal Information to an Unauthorized Actor](https://cwe.mitre.org/data/definitions/359.html)

[CWE-377 Insecure Temporary File](https://cwe.mitre.org/data/definitions/377.html)

[CWE-402 Transmission of Private Resources into a New Sphere ('Resource Leak')](https://cwe.mitre.org/data/definitions/402.html)

[CWE-425 Direct Request ('Forced Browsing')](https://cwe.mitre.org/data/definitions/425.html)

[CWE-441 Unintended Proxy or Intermediary ('Confused Deputy')](https://cwe.mitre.org/data/definitions/441.html)

[CWE-497 Exposure of Sensitive System Information to an Unauthorized Control Sphere](https://cwe.mitre.org/data/definitions/497.html)

[CWE-538 Insertion of Sensitive Information into Externally-Accessible File or Directory](https://cwe.mitre.org/data/definitions/538.html)

[CWE-540 Inclusion of Sensitive Information in Source Code](https://cwe.mitre.org/data/definitions/540.html)

[CWE-548 Exposure of Information Through Directory Listing](https://cwe.mitre.org/data/definitions/548.html)

[CWE-552 Files or Directories Accessible to External Parties](https://cwe.mitre.org/data/definitions/552.html)

[CWE-566 Authorization Bypass Through User-Controlled SQL Primary Key](https://cwe.mitre.org/data/definitions/566.html)

[CWE-601 URL Redirection to Untrusted Site ('Open Redirect')](https://cwe.mitre.org/data/definitions/601.html)

[CWE-639 Authorization Bypass Through User-Controlled Key](https://cwe.mitre.org/data/definitions/639.html)

[CWE-651 Exposure of WSDL File Containing Sensitive Information](https://cwe.mitre.org/data/definitions/651.html)

[CWE-668 Exposure of Resource to Wrong Sphere](https://cwe.mitre.org/data/definitions/668.html)

[CWE-706 Use of Incorrectly-Resolved Name or Reference](https://cwe.mitre.org/data/definitions/706.html)

[CWE-862 Missing Authorization](https://cwe.mitre.org/data/definitions/862.html)

[CWE-863 Incorrect Authorization](https://cwe.mitre.org/data/definitions/863.html)

[CWE-913 Improper Control of Dynamically-Managed Code Resources](https://cwe.mitre.org/data/definitions/913.html)

[CWE-922 Insecure Storage of Sensitive Information](https://cwe.mitre.org/data/definitions/922.html)

[CWE-1275 Sensitive Cookie with Improper SameSite Attribute](https://cwe.mitre.org/data/definitions/1275.html)

<mark style="color:red;">**Recursos**</mark>

{% embed url="https://owasp.org/Top10/A01_2021-Broken_Access_Control/" %}

{% embed url="https://www.packetlabs.net/posts/broken-access-control/" %}
